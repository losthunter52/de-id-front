import{c as Se,f as Fe,j as _e,a as B,h as de,b as Ie,m as Te,E as De,g as xe,r as Ee,x as ze,A as Re,q as Le,aa as Pe,v as qe}from"./index.fdeaed34.js";import{b as Ne}from"./QCheckbox.5fe3b179.js";import{u as je,a as Me,b as Ue,c as Be,d as Ke,e as Qe,f as Oe}from"./use-key-composition.f203cbf4.js";import{a as Ve}from"./use-quasar.db671c70.js";import{h as We}from"./format.216baa70.js";var nt=Se({name:"QPage",props:{padding:Boolean,styleFn:Function},setup(f,{slots:M}){const{proxy:{$q:H}}=xe(),g=Fe(Te,_e);if(g===_e)return console.error("QPage needs to be a deep child of QLayout"),_e;if(Fe(De,_e)===_e)return console.error("QPage needs to be child of QPageContainer"),_e;const A=B(()=>{const Q=(g.header.space===!0?g.header.size:0)+(g.footer.space===!0?g.footer.size:0);if(typeof f.styleFn=="function"){const l=g.isContainer.value===!0?g.containerHeight.value:H.screen.height;return f.styleFn(Q,l)}return{minHeight:g.isContainer.value===!0?g.containerHeight.value-Q+"px":H.screen.height===0?Q!==0?`calc(100vh - ${Q}px)`:"100vh":H.screen.height-Q+"px"}}),K=B(()=>`q-page${f.padding===!0?" q-layout-padding":""}`);return()=>de("main",{class:K.value,style:A.value},Ie(M.default))}});function ye(f,M,H,g){const k=[];return f.forEach(A=>{g(A)===!0?k.push(A):M.push({failedPropValidation:H,file:A})}),k}function ke(f){f&&f.dataTransfer&&(f.dataTransfer.dropEffect="copy"),Re(f)}const He={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},$e=["rejected"];function Je({editable:f,dnd:M,getFileInput:H,addFilesToQueue:g}){const{props:k,emit:A,proxy:K}=xe(),Q=Ee(null),l=B(()=>k.accept!==void 0?k.accept.split(",").map(h=>(h=h.trim(),h==="*"?"*/":(h.endsWith("/*")&&(h=h.slice(0,h.length-1)),h.toUpperCase()))):null),Z=B(()=>parseInt(k.maxFiles,10)),V=B(()=>parseInt(k.maxTotalSize,10));function ne(h){if(f.value)if(h!==Object(h)&&(h={target:null}),h.target!==null&&h.target.matches('input[type="file"]')===!0)h.clientX===0&&h.clientY===0&&ze(h);else{const W=H();W&&W!==h.target&&W.click(h)}}function ie(h){f.value&&h&&g(null,h)}function re(h,W,le,se){let m=Array.from(W||h.target.files);const d=[],t=()=>{d.length!==0&&A("rejected",d)};if(k.accept!==void 0&&l.value.indexOf("*/")===-1&&(m=ye(m,d,"accept",e=>l.value.some(n=>e.type.toUpperCase().startsWith(n)||e.name.toUpperCase().endsWith(n))),m.length===0))return t();if(k.maxFileSize!==void 0){const e=parseInt(k.maxFileSize,10);if(m=ye(m,d,"max-file-size",n=>n.size<=e),m.length===0)return t()}if(k.multiple!==!0&&m.length!==0&&(m=[m[0]]),m.forEach(e=>{e.__key=e.webkitRelativePath+e.lastModified+e.name+e.size}),se===!0){const e=le.map(n=>n.__key);m=ye(m,d,"duplicate",n=>e.includes(n.__key)===!1)}if(m.length===0)return t();if(k.maxTotalSize!==void 0){let e=se===!0?le.reduce((n,r)=>n+r.size,0):0;if(m=ye(m,d,"max-total-size",n=>(e+=n.size,e<=V.value)),m.length===0)return t()}if(typeof k.filter=="function"){const e=k.filter(m);m=ye(m,d,"filter",n=>e.includes(n))}if(k.maxFiles!==void 0){let e=se===!0?le.length:0;if(m=ye(m,d,"max-files",()=>(e++,e<=Z.value)),m.length===0)return t()}if(t(),m.length!==0)return m}function ue(h){ke(h),M.value!==!0&&(M.value=!0)}function w(h){Re(h),(h.relatedTarget!==null||Le.is.safari!==!0?h.relatedTarget!==Q.value:document.elementsFromPoint(h.clientX,h.clientY).includes(Q.value)===!1)===!0&&(M.value=!1)}function ee(h){ke(h);const W=h.dataTransfer.files;W.length!==0&&g(null,W),M.value=!1}function pe(h){if(M.value===!0)return de("div",{ref:Q,class:`q-${h}__dnd absolute-full`,onDragenter:ke,onDragover:ke,onDragleave:w,onDrop:ee})}return Object.assign(K,{pickFiles:ne,addFiles:ie}),{pickFiles:ne,addFiles:ie,onDragover:ue,onDragleave:w,processFiles:re,getDndNode:pe,maxFilesNumber:Z,maxTotalSizeNumber:V}}var it=Se({name:"QFile",inheritAttrs:!1,props:{...je,...Me,...He,modelValue:[File,FileList,Array],append:Boolean,useChips:Boolean,displayValue:[String,Number],tabindex:{type:[String,Number],default:0},counterLabel:Function,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...Ue,...$e],setup(f,{slots:M,emit:H,attrs:g}){const{proxy:k}=xe(),A=Be(),K=Ee(null),Q=Ee(!1),l=Ke(f),{pickFiles:Z,onDragover:V,onDragleave:ne,processFiles:ie,getDndNode:re}=Je({editable:A.editable,dnd:Q,getFileInput:a,addFilesToQueue:c}),ue=Ve(f),w=B(()=>Object(f.modelValue)===f.modelValue?"length"in f.modelValue?Array.from(f.modelValue):[f.modelValue]:[]),ee=B(()=>Oe(w.value)),pe=B(()=>w.value.map(i=>i.name).join(", ")),h=B(()=>We(w.value.reduce((i,v)=>i+v.size,0))),W=B(()=>({totalSize:h.value,filesNumber:w.value.length,maxFiles:f.maxFiles})),le=B(()=>({tabindex:-1,type:"file",title:"",accept:f.accept,capture:f.capture,name:l.value,...g,id:A.targetUid.value,disabled:A.editable.value!==!0})),se=B(()=>"q-file q-field--auto-height"+(Q.value===!0?" q-file--dnd":"")),m=B(()=>f.multiple===!0&&f.append===!0);function d(i){const v=w.value.slice();v.splice(i,1),e(v)}function t(i){const v=w.value.indexOf(i);v>-1&&d(v)}function e(i){H("update:modelValue",f.multiple===!0?i:i[0])}function n(i){i.keyCode===13&&qe(i)}function r(i){(i.keyCode===13||i.keyCode===32)&&Z(i)}function a(){return K.value}function c(i,v){const o=ie(i,v,w.value,m.value),U=a();U!=null&&(U.value=""),o!==void 0&&((f.multiple===!0?f.modelValue&&o.every(z=>w.value.includes(z)):f.modelValue===o[0])||e(m.value===!0?w.value.concat(o):o))}function p(){return[de("input",{class:[f.inputClass,"q-file__filler"],style:f.inputStyle})]}function T(){if(M.file!==void 0)return w.value.length===0?p():w.value.map((v,o)=>M.file({index:o,file:v,ref:this}));if(M.selected!==void 0)return w.value.length===0?p():M.selected({files:w.value,ref:this});if(f.useChips===!0)return w.value.length===0?p():w.value.map((v,o)=>de(Ne,{key:"file-"+o,removable:A.editable.value,dense:!0,textColor:f.color,tabindex:f.tabindex,onRemove:()=>{d(o)}},()=>de("span",{class:"ellipsis",textContent:v.name})));const i=f.displayValue!==void 0?f.displayValue:pe.value;return i.length!==0?[de("div",{class:f.inputClass,style:f.inputStyle,textContent:i})]:p()}function E(){const i={ref:K,...le.value,...ue.value,class:"q-field__input fit absolute-full cursor-pointer",onChange:c};return f.multiple===!0&&(i.multiple=!0),de("input",i)}return Object.assign(A,{fieldClass:se,emitValue:e,hasValue:ee,inputRef:K,innerValue:w,floatingLabel:B(()=>ee.value===!0||Oe(f.displayValue)),computedCounter:B(()=>{if(f.counterLabel!==void 0)return f.counterLabel(W.value);const i=f.maxFiles;return`${w.value.length}${i!==void 0?" / "+i:""} (${h.value})`}),getControlChild:()=>re("file"),getControl:()=>{const i={ref:A.targetRef,class:"q-field__native row items-center cursor-pointer",tabindex:f.tabindex};return A.editable.value===!0&&Object.assign(i,{onDragover:V,onDragleave:ne,onKeydown:n,onKeyup:r}),de("div",i,[E()].concat(T()))}}),Object.assign(k,{removeAtIndex:d,removeFile:t,getNativeElement:()=>K.value}),Pe(k,"nativeEl",()=>K.value),Qe(A)}}),Ye=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},Ae={exports:{}};/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/(function(f,M){(function(H,g){f.exports=g()})(Ye,function H(){var g=typeof self!="undefined"?self:typeof window!="undefined"?window:g!==void 0?g:{},k=!g.document&&!!g.postMessage,A=g.IS_PAPA_WORKER||!1,K={},Q=0,l={parse:function(t,e){var n=(e=e||{}).dynamicTyping||!1;if(d(n)&&(e.dynamicTypingFunction=n,n={}),e.dynamicTyping=n,e.transform=!!d(e.transform)&&e.transform,e.worker&&l.WORKERS_SUPPORTED){var r=function(){if(!l.WORKERS_SUPPORTED)return!1;var c=(T=g.URL||g.webkitURL||null,E=H.toString(),l.BLOB_URL||(l.BLOB_URL=T.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",E,")();"],{type:"text/javascript"})))),p=new g.Worker(c),T,E;return p.onmessage=h,p.id=Q++,K[p.id]=p}();return r.userStep=e.step,r.userChunk=e.chunk,r.userComplete=e.complete,r.userError=e.error,e.step=d(e.step),e.chunk=d(e.chunk),e.complete=d(e.complete),e.error=d(e.error),delete e.worker,void r.postMessage({input:t,config:e,workerId:r.id})}var a=null;return l.NODE_STREAM_INPUT,typeof t=="string"?(t=function(c){return c.charCodeAt(0)===65279?c.slice(1):c}(t),a=e.download?new ne(e):new re(e)):t.readable===!0&&d(t.read)&&d(t.on)?a=new ue(e):(g.File&&t instanceof File||t instanceof Object)&&(a=new ie(e)),a.stream(t)},unparse:function(t,e){var n=!1,r=!0,a=",",c=`\r
`,p='"',T=p+p,E=!1,i=null,v=!1;(function(){if(typeof e=="object"){if(typeof e.delimiter!="string"||l.BAD_DELIMITERS.filter(function(s){return e.delimiter.indexOf(s)!==-1}).length||(a=e.delimiter),(typeof e.quotes=="boolean"||typeof e.quotes=="function"||Array.isArray(e.quotes))&&(n=e.quotes),typeof e.skipEmptyLines!="boolean"&&typeof e.skipEmptyLines!="string"||(E=e.skipEmptyLines),typeof e.newline=="string"&&(c=e.newline),typeof e.quoteChar=="string"&&(p=e.quoteChar),typeof e.header=="boolean"&&(r=e.header),Array.isArray(e.columns)){if(e.columns.length===0)throw new Error("Option columns is empty");i=e.columns}e.escapeChar!==void 0&&(T=e.escapeChar+p),(typeof e.escapeFormulae=="boolean"||e.escapeFormulae instanceof RegExp)&&(v=e.escapeFormulae instanceof RegExp?e.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var o=new RegExp(ee(p),"g");if(typeof t=="string"&&(t=JSON.parse(t)),Array.isArray(t)){if(!t.length||Array.isArray(t[0]))return U(null,t,E);if(typeof t[0]=="object")return U(i||Object.keys(t[0]),t,E)}else if(typeof t=="object")return typeof t.data=="string"&&(t.data=JSON.parse(t.data)),Array.isArray(t.data)&&(t.fields||(t.fields=t.meta&&t.meta.fields||i),t.fields||(t.fields=Array.isArray(t.data[0])?t.fields:typeof t.data[0]=="object"?Object.keys(t.data[0]):[]),Array.isArray(t.data[0])||typeof t.data[0]=="object"||(t.data=[t.data])),U(t.fields||[],t.data||[],E);throw new Error("Unable to serialize unrecognized input");function U(s,x,N){var S="";typeof s=="string"&&(s=JSON.parse(s)),typeof x=="string"&&(x=JSON.parse(x));var q=Array.isArray(s)&&0<s.length,L=!Array.isArray(x[0]);if(q&&r){for(var P=0;P<s.length;P++)0<P&&(S+=a),S+=z(s[P],P);0<x.length&&(S+=c)}for(var u=0;u<x.length;u++){var _=q?s.length:x[u].length,F=!1,D=q?Object.keys(x[u]).length===0:x[u].length===0;if(N&&!q&&(F=N==="greedy"?x[u].join("").trim()==="":x[u].length===1&&x[u][0].length===0),N==="greedy"&&q){for(var b=[],j=0;j<_;j++){var R=L?s[j]:j;b.push(x[u][R])}F=b.join("").trim()===""}if(!F){for(var C=0;C<_;C++){0<C&&!D&&(S+=a);var X=q&&L?s[C]:C;S+=z(x[u][X],C)}u<x.length-1&&(!N||0<_&&!D)&&(S+=c)}}return S}function z(s,x){if(s==null)return"";if(s.constructor===Date)return JSON.stringify(s).slice(1,25);var N=!1;v&&typeof s=="string"&&v.test(s)&&(s="'"+s,N=!0);var S=s.toString().replace(o,T);return(N=N||n===!0||typeof n=="function"&&n(s,x)||Array.isArray(n)&&n[x]||function(q,L){for(var P=0;P<L.length;P++)if(-1<q.indexOf(L[P]))return!0;return!1}(S,l.BAD_DELIMITERS)||-1<S.indexOf(a)||S.charAt(0)===" "||S.charAt(S.length-1)===" ")?p+S+p:S}}};if(l.RECORD_SEP=String.fromCharCode(30),l.UNIT_SEP=String.fromCharCode(31),l.BYTE_ORDER_MARK="\uFEFF",l.BAD_DELIMITERS=["\r",`
`,'"',l.BYTE_ORDER_MARK],l.WORKERS_SUPPORTED=!k&&!!g.Worker,l.NODE_STREAM_INPUT=1,l.LocalChunkSize=10485760,l.RemoteChunkSize=5242880,l.DefaultDelimiter=",",l.Parser=pe,l.ParserHandle=w,l.NetworkStreamer=ne,l.FileStreamer=ie,l.StringStreamer=re,l.ReadableStreamStreamer=ue,g.jQuery){var Z=g.jQuery;Z.fn.parse=function(t){var e=t.config||{},n=[];return this.each(function(c){if(!(Z(this).prop("tagName").toUpperCase()==="INPUT"&&Z(this).attr("type").toLowerCase()==="file"&&g.FileReader)||!this.files||this.files.length===0)return!0;for(var p=0;p<this.files.length;p++)n.push({file:this.files[p],inputElem:this,instanceConfig:Z.extend({},e)})}),r(),this;function r(){if(n.length!==0){var c,p,T,E,i=n[0];if(d(t.before)){var v=t.before(i.file,i.inputElem);if(typeof v=="object"){if(v.action==="abort")return c="AbortError",p=i.file,T=i.inputElem,E=v.reason,void(d(t.error)&&t.error({name:c},p,T,E));if(v.action==="skip")return void a();typeof v.config=="object"&&(i.instanceConfig=Z.extend(i.instanceConfig,v.config))}else if(v==="skip")return void a()}var o=i.instanceConfig.complete;i.instanceConfig.complete=function(U){d(o)&&o(U,i.file,i.inputElem),a()},l.parse(i.file,i.instanceConfig)}else d(t.complete)&&t.complete()}function a(){n.splice(0,1),r()}}}function V(t){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(e){var n=se(e);n.chunkSize=parseInt(n.chunkSize),e.step||e.chunk||(n.chunkSize=null),this._handle=new w(n),(this._handle.streamer=this)._config=n}.call(this,t),this.parseChunk=function(e,n){if(this.isFirstChunk&&d(this._config.beforeFirstChunk)){var r=this._config.beforeFirstChunk(e);r!==void 0&&(e=r)}this.isFirstChunk=!1,this._halted=!1;var a=this._partialLine+e;this._partialLine="";var c=this._handle.parse(a,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var p=c.meta.cursor;this._finished||(this._partialLine=a.substring(p-this._baseIndex),this._baseIndex=p),c&&c.data&&(this._rowCount+=c.data.length);var T=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(A)g.postMessage({results:c,workerId:l.WORKER_ID,finished:T});else if(d(this._config.chunk)&&!n){if(this._config.chunk(c,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);c=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(c.data),this._completeResults.errors=this._completeResults.errors.concat(c.errors),this._completeResults.meta=c.meta),this._completed||!T||!d(this._config.complete)||c&&c.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),T||c&&c.meta.paused||this._nextChunk(),c}this._halted=!0},this._sendError=function(e){d(this._config.error)?this._config.error(e):A&&this._config.error&&g.postMessage({workerId:l.WORKER_ID,error:e,finished:!1})}}function ne(t){var e;(t=t||{}).chunkSize||(t.chunkSize=l.RemoteChunkSize),V.call(this,t),this._nextChunk=k?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(n){this._input=n,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(e=new XMLHttpRequest,this._config.withCredentials&&(e.withCredentials=this._config.withCredentials),k||(e.onload=m(this._chunkLoaded,this),e.onerror=m(this._chunkError,this)),e.open(this._config.downloadRequestBody?"POST":"GET",this._input,!k),this._config.downloadRequestHeaders){var n=this._config.downloadRequestHeaders;for(var r in n)e.setRequestHeader(r,n[r])}if(this._config.chunkSize){var a=this._start+this._config.chunkSize-1;e.setRequestHeader("Range","bytes="+this._start+"-"+a)}try{e.send(this._config.downloadRequestBody)}catch(c){this._chunkError(c.message)}k&&e.status===0&&this._chunkError()}},this._chunkLoaded=function(){e.readyState===4&&(e.status<200||400<=e.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:e.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(n){var r=n.getResponseHeader("Content-Range");return r===null?-1:parseInt(r.substring(r.lastIndexOf("/")+1))}(e),this.parseChunk(e.responseText)))},this._chunkError=function(n){var r=e.statusText||n;this._sendError(new Error(r))}}function ie(t){var e,n;(t=t||{}).chunkSize||(t.chunkSize=l.LocalChunkSize),V.call(this,t);var r=typeof FileReader!="undefined";this.stream=function(a){this._input=a,n=a.slice||a.webkitSlice||a.mozSlice,r?((e=new FileReader).onload=m(this._chunkLoaded,this),e.onerror=m(this._chunkError,this)):e=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var a=this._input;if(this._config.chunkSize){var c=Math.min(this._start+this._config.chunkSize,this._input.size);a=n.call(a,this._start,c)}var p=e.readAsText(a,this._config.encoding);r||this._chunkLoaded({target:{result:p}})},this._chunkLoaded=function(a){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(a.target.result)},this._chunkError=function(){this._sendError(e.error)}}function re(t){var e;V.call(this,t=t||{}),this.stream=function(n){return e=n,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var n,r=this._config.chunkSize;return r?(n=e.substring(0,r),e=e.substring(r)):(n=e,e=""),this._finished=!e,this.parseChunk(n)}}}function ue(t){V.call(this,t=t||{});var e=[],n=!0,r=!1;this.pause=function(){V.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){V.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(a){this._input=a,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){r&&e.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),e.length?this.parseChunk(e.shift()):n=!0},this._streamData=m(function(a){try{e.push(typeof a=="string"?a:a.toString(this._config.encoding)),n&&(n=!1,this._checkIsFinished(),this.parseChunk(e.shift()))}catch(c){this._streamError(c)}},this),this._streamError=m(function(a){this._streamCleanUp(),this._sendError(a)},this),this._streamEnd=m(function(){this._streamCleanUp(),r=!0,this._streamData("")},this),this._streamCleanUp=m(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function w(t){var e,n,r,a=Math.pow(2,53),c=-a,p=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,T=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,E=this,i=0,v=0,o=!1,U=!1,z=[],s={data:[],errors:[],meta:{}};if(d(t.step)){var x=t.step;t.step=function(u){if(s=u,q())S();else{if(S(),s.data.length===0)return;i+=u.data.length,t.preview&&i>t.preview?n.abort():(s.data=s.data[0],x(s,E))}}}function N(u){return t.skipEmptyLines==="greedy"?u.join("").trim()==="":u.length===1&&u[0].length===0}function S(){return s&&r&&(P("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+l.DefaultDelimiter+"'"),r=!1),t.skipEmptyLines&&(s.data=s.data.filter(function(u){return!N(u)})),q()&&function(){if(!s)return;function u(F,D){d(t.transformHeader)&&(F=t.transformHeader(F,D)),z.push(F)}if(Array.isArray(s.data[0])){for(var _=0;q()&&_<s.data.length;_++)s.data[_].forEach(u);s.data.splice(0,1)}else s.data.forEach(u)}(),function(){if(!s||!t.header&&!t.dynamicTyping&&!t.transform)return s;function u(F,D){var b,j=t.header?{}:[];for(b=0;b<F.length;b++){var R=b,C=F[b];t.header&&(R=b>=z.length?"__parsed_extra":z[b]),t.transform&&(C=t.transform(C,R)),C=L(R,C),R==="__parsed_extra"?(j[R]=j[R]||[],j[R].push(C)):j[R]=C}return t.header&&(b>z.length?P("FieldMismatch","TooManyFields","Too many fields: expected "+z.length+" fields but parsed "+b,v+D):b<z.length&&P("FieldMismatch","TooFewFields","Too few fields: expected "+z.length+" fields but parsed "+b,v+D)),j}var _=1;return!s.data.length||Array.isArray(s.data[0])?(s.data=s.data.map(u),_=s.data.length):s.data=u(s.data,0),t.header&&s.meta&&(s.meta.fields=z),v+=_,s}()}function q(){return t.header&&z.length===0}function L(u,_){return F=u,t.dynamicTypingFunction&&t.dynamicTyping[F]===void 0&&(t.dynamicTyping[F]=t.dynamicTypingFunction(F)),(t.dynamicTyping[F]||t.dynamicTyping)===!0?_==="true"||_==="TRUE"||_!=="false"&&_!=="FALSE"&&(function(D){if(p.test(D)){var b=parseFloat(D);if(c<b&&b<a)return!0}return!1}(_)?parseFloat(_):T.test(_)?new Date(_):_===""?null:_):_;var F}function P(u,_,F,D){var b={type:u,code:_,message:F};D!==void 0&&(b.row=D),s.errors.push(b)}this.parse=function(u,_,F){var D=t.quoteChar||'"';if(t.newline||(t.newline=function(R,C){R=R.substring(0,1048576);var X=new RegExp(ee(C)+"([^]*?)"+ee(C),"gm"),$=(R=R.replace(X,"")).split("\r"),te=R.split(`
`),ae=1<te.length&&te[0].length<$[0].length;if($.length===1||ae)return`
`;for(var J=0,O=0;O<$.length;O++)$[O][0]===`
`&&J++;return J>=$.length/2?`\r
`:"\r"}(u,D)),r=!1,t.delimiter)d(t.delimiter)&&(t.delimiter=t.delimiter(u),s.meta.delimiter=t.delimiter);else{var b=function(R,C,X,$,te){var ae,J,O,I;te=te||[",","	","|",";",l.RECORD_SEP,l.UNIT_SEP];for(var ge=0;ge<te.length;ge++){var y=te[ge],ve=0,oe=0,me=0;O=void 0;for(var fe=new pe({comments:$,delimiter:y,newline:C,preview:10}).parse(R),ce=0;ce<fe.data.length;ce++)if(X&&N(fe.data[ce]))me++;else{var he=fe.data[ce].length;oe+=he,O!==void 0?0<he&&(ve+=Math.abs(he-O),O=he):O=he}0<fe.data.length&&(oe/=fe.data.length-me),(J===void 0||ve<=J)&&(I===void 0||I<oe)&&1.99<oe&&(J=ve,ae=y,I=oe)}return{successful:!!(t.delimiter=ae),bestDelimiter:ae}}(u,t.newline,t.skipEmptyLines,t.comments,t.delimitersToGuess);b.successful?t.delimiter=b.bestDelimiter:(r=!0,t.delimiter=l.DefaultDelimiter),s.meta.delimiter=t.delimiter}var j=se(t);return t.preview&&t.header&&j.preview++,e=u,n=new pe(j),s=n.parse(e,_,F),S(),o?{meta:{paused:!0}}:s||{meta:{paused:!1}}},this.paused=function(){return o},this.pause=function(){o=!0,n.abort(),e=d(t.chunk)?"":e.substring(n.getCharIndex())},this.resume=function(){E.streamer._halted?(o=!1,E.streamer.parseChunk(e,!0)):setTimeout(E.resume,3)},this.aborted=function(){return U},this.abort=function(){U=!0,n.abort(),s.meta.aborted=!0,d(t.complete)&&t.complete(s),e=""}}function ee(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function pe(t){var e,n=(t=t||{}).delimiter,r=t.newline,a=t.comments,c=t.step,p=t.preview,T=t.fastMode,E=e=t.quoteChar===void 0||t.quoteChar===null?'"':t.quoteChar;if(t.escapeChar!==void 0&&(E=t.escapeChar),(typeof n!="string"||-1<l.BAD_DELIMITERS.indexOf(n))&&(n=","),a===n)throw new Error("Comment character same as delimiter");a===!0?a="#":(typeof a!="string"||-1<l.BAD_DELIMITERS.indexOf(a))&&(a=!1),r!==`
`&&r!=="\r"&&r!==`\r
`&&(r=`
`);var i=0,v=!1;this.parse=function(o,U,z){if(typeof o!="string")throw new Error("Input must be a string");var s=o.length,x=n.length,N=r.length,S=a.length,q=d(c),L=[],P=[],u=[],_=i=0;if(!o)return Y();if(t.header&&!U){var F=o.split(r)[0].split(n),D=[],b={},j=!1;for(var R in F){var C=F[R];d(t.transformHeader)&&(C=t.transformHeader(C,R));var X=C,$=b[C]||0;for(0<$&&(j=!0,X=C+"_"+$),b[C]=$+1;D.includes(X);)X=X+"_"+$;D.push(X)}if(j){var te=o.split(r);te[0]=D.join(n),o=te.join(r)}}if(T||T!==!1&&o.indexOf(e)===-1){for(var ae=o.split(r),J=0;J<ae.length;J++){if(u=ae[J],i+=u.length,J!==ae.length-1)i+=r.length;else if(z)return Y();if(!a||u.substring(0,S)!==a){if(q){if(L=[],me(u.split(n)),be(),v)return Y()}else me(u.split(n));if(p&&p<=J)return L=L.slice(0,p),Y(!0)}}return Y()}for(var O=o.indexOf(n,i),I=o.indexOf(r,i),ge=new RegExp(ee(E)+ee(e),"g"),y=o.indexOf(e,i);;)if(o[i]!==e)if(a&&u.length===0&&o.substring(i,i+S)===a){if(I===-1)return Y();i=I+N,I=o.indexOf(r,i),O=o.indexOf(n,i)}else if(O!==-1&&(O<I||I===-1))u.push(o.substring(i,O)),i=O+x,O=o.indexOf(n,i);else{if(I===-1)break;if(u.push(o.substring(i,I)),he(I+N),q&&(be(),v))return Y();if(p&&L.length>=p)return Y(!0)}else for(y=i,i++;;){if((y=o.indexOf(e,y+1))===-1)return z||P.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:L.length,index:i}),ce();if(y===s-1)return ce(o.substring(i,y).replace(ge,e));if(e!==E||o[y+1]!==E){if(e===E||y===0||o[y-1]!==E){O!==-1&&O<y+1&&(O=o.indexOf(n,y+1)),I!==-1&&I<y+1&&(I=o.indexOf(r,y+1));var ve=fe(I===-1?O:Math.min(O,I));if(o.substr(y+1+ve,x)===n){u.push(o.substring(i,y).replace(ge,e)),o[i=y+1+ve+x]!==e&&(y=o.indexOf(e,i)),O=o.indexOf(n,i),I=o.indexOf(r,i);break}var oe=fe(I);if(o.substring(y+1+oe,y+1+oe+N)===r){if(u.push(o.substring(i,y).replace(ge,e)),he(y+1+oe+N),O=o.indexOf(n,i),y=o.indexOf(e,i),q&&(be(),v))return Y();if(p&&L.length>=p)return Y(!0);break}P.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:L.length,index:i}),y++}}else y++}return ce();function me(G){L.push(G),_=i}function fe(G){var we=0;if(G!==-1){var Ce=o.substring(y+1,G);Ce&&Ce.trim()===""&&(we=Ce.length)}return we}function ce(G){return z||(G===void 0&&(G=o.substring(i)),u.push(G),i=s,me(u),q&&be()),Y()}function he(G){i=G,me(u),u=[],I=o.indexOf(r,i)}function Y(G){return{data:L,errors:P,meta:{delimiter:n,linebreak:r,aborted:v,truncated:!!G,cursor:_+(U||0)}}}function be(){c(Y()),L=[],P=[]}},this.abort=function(){v=!0},this.getCharIndex=function(){return i}}function h(t){var e=t.data,n=K[e.workerId],r=!1;if(e.error)n.userError(e.error,e.file);else if(e.results&&e.results.data){var a={abort:function(){r=!0,W(e.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:le,resume:le};if(d(n.userStep)){for(var c=0;c<e.results.data.length&&(n.userStep({data:e.results.data[c],errors:e.results.errors,meta:e.results.meta},a),!r);c++);delete e.results}else d(n.userChunk)&&(n.userChunk(e.results,a,e.file),delete e.results)}e.finished&&!r&&W(e.workerId,e.results)}function W(t,e){var n=K[t];d(n.userComplete)&&n.userComplete(e),n.terminate(),delete K[t]}function le(){throw new Error("Not implemented.")}function se(t){if(typeof t!="object"||t===null)return t;var e=Array.isArray(t)?[]:{};for(var n in t)e[n]=se(t[n]);return e}function m(t,e){return function(){t.apply(e,arguments)}}function d(t){return typeof t=="function"}return A&&(g.onmessage=function(t){var e=t.data;if(l.WORKER_ID===void 0&&e&&(l.WORKER_ID=e.workerId),typeof e.input=="string")g.postMessage({workerId:l.WORKER_ID,results:l.parse(e.input,e.config),finished:!0});else if(g.File&&e.input instanceof File||e.input instanceof Object){var n=l.parse(e.input,e.config);n&&g.postMessage({workerId:l.WORKER_ID,results:n,finished:!0})}}),(ne.prototype=Object.create(V.prototype)).constructor=ne,(ie.prototype=Object.create(V.prototype)).constructor=ie,(re.prototype=Object.create(re.prototype)).constructor=re,(ue.prototype=Object.create(V.prototype)).constructor=ue,l})})(Ae);var rt=Ae.exports;export{rt as P,it as Q,nt as a};
