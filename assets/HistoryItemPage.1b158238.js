import{_ as p,K as n,a5 as l,N as i,M as d,Q as h,a8 as c,a6 as g,aw as b,ax as w,P as _,a4 as v,J as C,L as T}from"./index.431c2acb.js";import{e as x,Q as m}from"./export-file.f4fadcf0.js";import{Q as u}from"./QCard.2098204a.js";import{Q as k}from"./QCircularProgress.205a25aa.js";import{r as D}from"./routers.de2dd85d.js";import"./QSeparator.8b567366.js";import"./use-dark.780b0e18.js";import"./QList.3e6a53f3.js";import"./QCheckbox.9cad8a68.js";import"./use-key-composition.de1f7167.js";import"./format.825448b2.js";import"./selection.e765c3e1.js";const S={props:{jsonData:{}},data(){return{title:"Table",isLoading:!0,isErrors:!1,disableDownload:!1,errors:[],dynamicColumns:[],formattedData:[],analysis_columns:[],analysis_rows:[]}},watch:{jsonData:{immediate:!0,handler(a){a!==null&&this.parseJsonData(a)}}},methods:{parseJsonData(a){try{const e=JSON.parse(a);this.title=e.description,e.errors==="[]"?(this.analysis_columns=[{name:"type",label:"Type",field:"type",sortable:!0},{name:"original",label:"Original",field:"original",sortable:!0},{name:"anonymized",label:"Anonymized",field:"anonymized",sortable:!0}],this.analysis_rows=[{type:"K-Anonymity",anonymized:e.anonymized_data_k_anonymity,original:e.real_data_k_anonymity},{type:"L-Diversity",anonymized:e.anonymized_data_l_diversity,original:e.real_data_l_diversity},{type:"T-Closeness",anonymized:e.anonymized_data_t_closeness,original:e.real_data_t_closeness}]):(this.analysis_columns=[{name:"type",label:"Type",field:"type",sortable:!0},{name:"original",label:"Original",field:"original",sortable:!0}],this.analysis_rows=[{type:"K-Anonymity",original:e.real_data_k_anonymity},{type:"L-Diversity",original:e.real_data_l_diversity},{type:"T-Closeness",original:e.real_data_t_closeness}],this.isLoading=!1,this.disableDownload=!0,this.$q.notify({message:"Error",caption:e.errors,icon:"error",color:"red"}));const o=JSON.parse(e.results);Array.isArray(o)?(this.formattedData=o,this.dynamicColumns=Object.keys(o[0]).map(t=>({name:t,label:t,field:t,sortable:!0})),this.isLoading=!1):this.$q.notify({message:"Error",caption:"Invalid Results",icon:"error",color:"red"})}catch(e){console.error("",e)}},exportTable(){const a=[this.dynamicColumns.map(o=>this.wrapCsvValue(o.label))].concat(this.formattedData.map(o=>this.dynamicColumns.map(t=>this.wrapCsvValue(typeof t.field=="function"?t.field(o):o[t.field===void 0?t.name:t.field])).join(","))).join(`\r
`);x(this.title.concat(".csv"),a,"text/csv")!==!0&&this.$q.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})},wrapCsvValue(a,e,o){let t=e!==void 0?e(a,o):a;return t=t==null?"":String(t),t=t.split('"').join('""'),`"${t}"`}}},y=a=>(b("data-v-75511e94"),a=a(),w(),a),j={key:0,class:"q-pa-md"},z=y(()=>_("br",null,null,-1)),L=y(()=>_("br",null,null,-1)),A={key:1,class:"q-pa-md flex flex-center loading-center"};function q(a,e,o,t,s,r){return n(),l(g,null,[s.isLoading?c("",!0):(n(),l("div",j,[i(u,{class:"q-pa-lg"},{default:d(()=>[i(m,{flat:"",bordered:"",dense:"",title:s.title,rows:s.formattedData,columns:s.dynamicColumns,"row-key":"id"},{"top-right":d(()=>[i(h,{color:"primary","icon-right":"archive",label:"Export to CSV","no-caps":"",onClick:r.exportTable,disable:s.disableDownload},null,8,["onClick","disable"])]),_:1},8,["title","rows","columns"])]),_:1}),z,i(u,{class:"q-pa-md"},{default:d(()=>[i(m,{grid:"",flat:"",bordered:"",title:"Analysis",rows:s.analysis_rows,columns:s.analysis_columns,"row-key":"name","hide-header":"","hide-bottom":""},null,8,["rows","columns"]),L]),_:1})])),s.isLoading?(n(),l("div",A,[i(k,{indeterminate:"",rounded:"",size:"50px",color:"light-blue",class:"q-ma-md"})])):c("",!0)],64)}var E=p(S,[["render",q],["__scopeId","data-v-75511e94"]]);const Q={props:{id:String},data(){return{items:{results:[]},jsonResult:null}},async mounted(){const a=v(),e=this.id;let o=!0;const t=s=>new Promise(r=>setTimeout(r,s));for(;o;){try{const s=await fetch(D.RESULTS_DETAILS+`${e}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Token ${a.token}`}});if(s.ok){const r=await s.json();this.items.results=r.results,this.jsonResult=JSON.stringify(r,null,2),o=!1}else console.error("",s.statusText)}catch(s){console.error("",s)}await t(5e3)}},components:{MountTable:E}};function I(a,e,o,t,s,r){const f=C("MountTable");return n(),T(f,{"json-data":s.jsonResult},null,8,["json-data"])}var H=p(Q,[["render",I]]);export{H as default};
