import{Q as ee,P as ae,a as te}from"./papaparse.min.0cc7f589.js";import{c as ne,a as le,h as se,b as oe,_ as K,a3 as re,r as i,a4 as D,K as m,L as P,M as V,N as d,R as ie,a5 as S,a6 as j,a7 as E,a8 as w,P as v,Q as ce,a9 as de,I as ue,J as me}from"./index.ac53a0ac.js";import{Q as L,a as F}from"./QCheckbox.6a822b03.js";import{Q as _e}from"./QInput.9137b8b7.js";import{Q as M}from"./QCard.6ac09fa6.js";import{u as fe}from"./use-quasar.b4aa5328.js";import{r as pe}from"./routers.4230d415.js";import"./use-key-composition.68ad8c4b.js";import"./use-dark.8e8f74ff.js";import"./format.2e9e377a.js";import"./selection.3b14088c.js";var J=ne({name:"QCardSection",props:{tag:{type:String,default:"div"},horizontal:Boolean},setup(f,{slots:h}){const u=le(()=>`q-card__section q-card__section--${f.horizontal===!0?"horiz row no-wrap":"vert"}`);return()=>se(f.tag,{class:u.value},oe(h.default))}});const ve={setup(){const f=fe(),h=re(),u=i(null),e=D(),Q=i(e.isAuthenticated),g=i(null),a=i([]),y=i({}),r=i(["encrypt","generalize","hash","mask","null_out","perturb","pseudonymize","swap"]),c=i({}),U={encrypt:["chacha20","aes","salsa20"],generalize:["percent","age"],hash:["md5","sha1","sha256"],mask:["full","range","first_n_characters","last_n_characters","email","cpf"],null_out:["columns"],perturb:["date","numeric_range","numeric_gaussian","numeric_laplacian"],pseudonymize:["columns","rows"],swap:["columns","rows"]},q=i({}),N=i({}),T=i({}),Y=i(null),x=i({salsa20:{key:""},aes:{key:""},chacha20:{key:""},first_n_characters:{n:""},last_n_characters:{n:""},range:{start_index:"",end_index:""},date:{unit:"",min_value:"",max_value:""},numeric_range:{min_value:"",max_value:""},numeric_gaussian:{std:""},numeric_laplacian:{value:""}}),z=i(!1);function G(){try{if(u.value){const t=u.value[0],o=new FileReader;o.onload=s=>{ae.parse(s.target.result,{header:!0,complete:n=>{a.value=Object.keys(n.data[0]),g.value=n.data,g.value.length>0&&(y.value={},c.value={})},error:n=>{console.error("Error parsing CSV:",n.message)}})},o.readAsText(t),z.value=!0}}catch(t){console.error("Error reading file:",t)}}function H(t){c.value[t]=null}function W(){const t={},o=[],s=[],n=[];let k="";u.value&&u.value.length>0&&(k=u.value[0].name);const B={string:l=>l.toString(),int:l=>parseInt(l),float:l=>parseFloat(l)};for(const l of a.value){const _=y.value[l],b=c.value[l];if(_&&b){const p=`${_}.${b}`;t[p]||(t[p]={algorithm:p,configuration:{},columns:[]}),t[p].columns.push(l)}q.value[l]&&o.push(l),N.value[l]&&s.push(l),T.value[l]&&n.push(l)}for(const l in c.value){const _=c.value[l],b=x.value[_];if(_&&b){const p={},$={salsa20:{key:"string"},aes:{key:"string"},chacha20:{key:"string"},first_n_characters:{n:"int"},last_n_characters:{n:"int"},range:{start_index:"int",end_index:"int"},date:{unit:"string",min_value:"int",max_value:"int"},numeric_range:{min_value:"int",max_value:"int"},numeric_gaussian:{std:"float"},numeric_laplacian:{value:"int"}};for(const C in b){if(x.value[_][C]=="")throw new Error("Configuration field missing");const O=x.value[_][C],R=$[_][C];B[R]?p[C]=B[R](O):p[C]=O}const I=`${y.value[l]}.${_}`;t[I]&&(t[I].configuration=p)}}return{description:k,execution_parameters:Object.values(t),sensitive_columns:o,diversity_columns:s,closeness_columns:n,data:g.value}}async function X(){try{const t=D(),o=W();let s="";if(o.execution_parameters.length?o.sensitive_columns.length?o.diversity_columns.length?o.closeness_columns.length?o.data.length||(s="data"):s="closeness_columns":s="diversity_columns":s="sensitive_columns":s="execution_parameters",s){f.notify({color:"red",textColor:"white",icon:"error",message:`Field '${s}' cannot be empty`});return}const n=await fetch(pe.ASYNC,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Token ${t.token}`},body:JSON.stringify(o)});if(n.ok){const k=await n.json();h.push(`/history/${k.task_id}`)}else f.notify({color:"red",textColor:"white",icon:"error",message:"Bad Request ".concat(n.status)})}catch(t){f.notify({color:"red",textColor:"white",icon:"error",message:" ".concat(t)})}}function A(t,o){return{salsa20:{key:"string"},aes:{key:"string"},chacha20:{key:"string"},first_n_characters:{n:"int"},last_n_characters:{n:"int"},range:{start_index:"int",end_index:"int"},date:{unit:"string",min_value:"int",max_value:"int"},numeric_range:{min_value:"int",max_value:"int"},numeric_gaussian:{std:"float"},numeric_laplacian:{value:"int"}}[t][o]}function Z(t,o){const s=A(t,o);if(s==="int")return[n=>isNaN(n)?"Please provide a valid number":!0];if(s==="string")return[n=>typeof n=="string"?!0:"Please provide a text"];if(s==="float")return[n=>!isNaN(n)&&!Number.isInteger(n)?!0:"Please provide a float value"]}return{files:u,userLoggedIn:Q,fileContent:g,columns:a,selectedColumns:y,firstSelectorOptions:r,selectedSecondSelectors:c,secondSelectorOptions:U,sensitiveColumns:q,diversityColumns:N,closenessColumns:T,payload:Y,secondSelectorVariables:x,showBtn:z,uploadFile:G,clearSecondSelector:H,onSubmit:X,getValidationRules:Z,getFieldType:A}}},he=v("div",{class:"text-h6 q-pb-md q-pl-sm"},"Anonymize",-1),ge={key:0},ye=v("br",null,null,-1),Se={class:"text-subtitle2",align:"center"},Ve={class:"column-options q-pa-md"},be={key:1},Ce=v("br",null,null,-1),xe={align:"center"},ke=v("br",null,null,-1),we={align:"right"};function Pe(f,h,u,e,Q,g){return m(),P(M,{class:"q-pa-md q-ma-md"},{default:V(()=>[he,d(ee,{modelValue:e.files,"onUpdate:modelValue":[h[0]||(h[0]=a=>e.files=a),e.uploadFile],label:"Drop or Select a File...",filled:"","max-files":"1",multiple:"",class:"custom-file-input",disable:!e.userLoggedIn,accept:".csv"},{prepend:V(()=>[d(ie,{name:"attach_file",class:"file-icon"})]),_:1},8,["modelValue","disable","onUpdate:modelValue"]),e.columns&&e.columns.length>0?(m(),S("div",ge,[ye,(m(!0),S(j,null,E(e.columns,(a,y)=>(m(),S("div",{key:y},[d(M,{class:"q-pa-md"},{default:V(()=>[d(J,null,{default:V(()=>[v("div",Se,de(a),1)]),_:2},1024),d(J,null,{default:V(()=>[v("div",Ve,[d(L,{modelValue:e.selectedColumns[a],"onUpdate:modelValue":[r=>e.selectedColumns[a]=r,r=>e.clearSecondSelector(a)],options:e.firstSelectorOptions,label:"Technique"},null,8,["modelValue","onUpdate:modelValue","options"]),e.selectedColumns[a]!==null?(m(),P(L,{key:0,modelValue:e.selectedSecondSelectors[a],"onUpdate:modelValue":r=>e.selectedSecondSelectors[a]=r,options:e.secondSelectorOptions[e.selectedColumns[a]],label:"Method"},null,8,["modelValue","onUpdate:modelValue","options"])):w("",!0),e.selectedSecondSelectors[a]?(m(),S("div",be,[(m(!0),S(j,null,E(e.secondSelectorVariables[e.selectedSecondSelectors[a]],(r,c)=>(m(),S("div",{key:c},[d(_e,{modelValue:e.secondSelectorVariables[e.selectedSecondSelectors[a]][c],"onUpdate:modelValue":U=>e.secondSelectorVariables[e.selectedSecondSelectors[a]][c]=U,label:c,rules:e.getValidationRules(e.selectedSecondSelectors[a],c)},null,8,["modelValue","onUpdate:modelValue","label","rules"])]))),128))])):w("",!0),Ce,v("div",xe,[d(F,{modelValue:e.sensitiveColumns[a],"onUpdate:modelValue":r=>e.sensitiveColumns[a]=r,label:"Sensitive"},null,8,["modelValue","onUpdate:modelValue"]),d(F,{modelValue:e.diversityColumns[a],"onUpdate:modelValue":r=>e.diversityColumns[a]=r,label:"Diversity"},null,8,["modelValue","onUpdate:modelValue"]),d(F,{modelValue:e.closenessColumns[a],"onUpdate:modelValue":r=>e.closenessColumns[a]=r,label:"Closeness"},null,8,["modelValue","onUpdate:modelValue"])])])]),_:2},1024)]),_:2},1024),ke]))),128))])):w("",!0),v("div",we,[e.showBtn?(m(),P(ce,{key:0,label:"Submit",color:"primary",onClick:e.onSubmit},null,8,["onClick"])):w("",!0)])]),_:1})}var Qe=K(ve,[["render",Pe]]);const Ue=ue({name:"IndexPage",components:{FilePicker:Qe}});function Fe(f,h,u,e,Q,g){const a=me("FilePicker");return m(),P(te,null,{default:V(()=>[d(a)]),_:1})}var Le=K(Ue,[["render",Fe]]);export{Le as default};
